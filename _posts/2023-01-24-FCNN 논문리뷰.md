---
layout: post
title: 논문리뷰-Fully automated deep-learning section-based muscle segmentation from CT images for sarcopenia assessment
subtitle: FCNN 기반 muscle segmentation model
categories: AI
tags: [FCNN, AI, segmentation]
---

## 1. 논문에서 사용된 배경지식

- #### 근감소증(sarcopenia)

    - 원인

    근감소증의 원인은 개인마다 다르지만, 가장 흔한 원인은 **단백질 섭취 저하, 운동량 부족, 운동 방법의 저하**입니다. 특히 필수 아미노산의 섭취 및 흡수가 부족하여 근감소증이 나타나는 비율이 매우 높습니다. 또 다른 흔한 원인으로는 노화와 동반된 호르몬 부족이 있습니다. 근감소증은 근육 자체에 생기는 질병 외에도 당뇨병, 감염증, 암 등 급만성 질환, 척추 협착증 등 퇴행성 질환에 의해 2차적으로 자주 발생합니다. 심장, 폐, 신장 부위의 만성 질환, 호르몬 질환 등이 발생한 경우 근감소증이 높은 빈도로 나타난다고 알려져 있습니다.

    - 증상

    근감소증의 증상으로는 근력 저하, 하지 무력감, 피곤감이 있습니다. 근육량과 근력은 나이가 들면서 자연스럽게 줄어들지만, 근감소증은 나이나 성별 등을 감안하더라도 **근육량과 근력이 지나치게 줄어들어 신체 기능이 떨어지며 건강상의 위험이나 사망률이 증가**합니다. 근감소증 환자는 걸음걸이가 늦어지고 근지구력이 떨어지며 일상생활이 어렵고 다른 사람의 도움이 자주 필요하게 됩니다. 또 골다공증, 낙상, 골절이 쉽게 발생합니다. 근육의 혈액 및 호르몬 완충 작용이 줄어들어, 기초대사량이 감소하고, 만성 질환 조절이 어렵게 되며, 당뇨병과 심혈관 질환이 쉽게 악화될 수 있습니다.

    - 진단

    근감소증은 근육량, 근력, 근 기능을 측정하여 진단합니다. 연령과 성별뿐만 아니라 키와 몸무게, 지방량에 따라 근육량의 정상치가 다릅니다. **근육량은 골격 근육량을 측정하여 확인**합니다. 이를 위해 이중에너지 방사선 흡수법(dual energy X-ray absorptiometry), 바이오임피던스 측정법, CT, MRI 등의 방법을 사용합니다. 근력은 다리 근력 또는 악력으로 측정합니다. 근 기능은 신체 기능을 평가하여 확인합니다. 이는 보행 속도 측정, short physical performance battery(SPPB 검사), 400미터 보행 검사, 6분 보행 검사 중 1~2가지를 실시하여 측정합니다.

- #### L3 lumbar vertebral

    Third lumbar vertebra (L3) slice has been found to be representative to the **whole body composition**.

    ![L3-lumbar-vertebral](https://user-images.githubusercontent.com/93850398/214489504-aad63858-79fb-48e5-b11f-307e0cce7b0f.jpg)

- #### maximal intensity projection(MIP)
    
    과학적 시각화에서 MIP(Maximum Intensity Projection)는 3D 데이터에 대한 방법으로 시점에서 투영 평면까지 추적되는 평행 광선의 경로에 **최대 강도**의 복셀을 시각화 평면에 투영합니다. 이 접근법을 사용하는 이유는 CT 스캔은 중요한 정보의 손실 없이 입력의 차원을 3D에서 2D로 줄이기 위함이다. 

    ![MIP](https://user-images.githubusercontent.com/93850398/214491706-c996cf2c-d0ac-4b9a-92de-9beace7664c5.jpg)

- #### fully convolution neural network(FCNN)

    완전연결층의 한계는 고정된 크기의 입력만 받아들이며, 완전연결층을 거친 후에는 위치 정보가 사라진다는 것입니다. 이러한 문제를 해결하기 위해 **완전연결층을 1×1 합성곱으로 대체**하는 것이 완전 합성곱 네트워크입니다. 즉, 완전 합성곱 네트워크(Fully Convolutional Neural Network, FCNN)는 이미지 분류에서 우수한 성능을 보인 CNN 기반 모델(AlexNet, VGG16, GoogLeNet)을 변형시켜 이미지 분할에 적합하도록 만든 네트워크입니다.

    ![FCNN](https://user-images.githubusercontent.com/93850398/214493304-cebef6d8-4a30-4303-bef6-7c2772c5b755.jpg)

    예를 들어 다음 그림과 같이 AlexNet의 하단에서 사용되었던 완전연결층 세 개를 1×1 합성곱으로 변환하면 **위치 정보가 남아 있기 때문에 히트 맵(heatmap)**을 통하여 고양이의 위치를 확인할 수 있습니다.

- #### U-net architecture

    U-net은 Biomedical 분야에서 이미지 분할을 목적으로 제안된 End-to-End 방식의 Fully convolution neural network 기반 모델이다.

- #### threefold cross-validation(hold-out test)

    Data set을 K개의 Fold로 나누어서 진행하는 교차검증이며, K번의 실험을 통해 1개는 Test set으로, K-1개는 Train set으로 반복적으로 실험하는 것이다. 최종 성능은 K번 실험 성능의 평균으로 도출한다. 총 데이터 갯수가 적은 데이터 셋에 대하여 정확도를 향상시킬 수 있고, 데이터의 수가 적은데 검증과 테스트를 했다면 underfitting 등 성능이 미달되는 모델이 학습되는데 이를 사전에 방지할 수 있다. 

    ![3-fold cross validation](https://user-images.githubusercontent.com/93850398/214600406-fc8d0f84-a428-425e-963b-7da4888c7bb0.png)

- #### Dice score

    Dice score는 두 개의 영역 A,B가 얼마나 겹치는 지를 나타내는 지표이다. Segmentation과 같은 기술을 사용할 때, 예측영역(Prediction)과 Ground-Truth가 얼마나 겹쳤는지를 비교할 때 사용한다.

    ![Dice score math](https://user-images.githubusercontent.com/93850398/214602474-84a5cb91-c824-4d18-bcf7-40e059768961.png)

    ![Dice score](https://user-images.githubusercontent.com/93850398/214603227-a1d2d1b6-f8db-40d4-88dd-26b623aa2536.png)

    Dice score의 값이 1에 가깝다면 FP영역과 FN영역이 거의 존재하지 않는다는 것을 뜻한다.

- #### Hounsfield unit(HU)

    X-ray beam이 물체를 통과할 때, beam이 물체에 얼마나 흡수되는지를 나타낸다. X-ray beam이 많이 흡수될수록 HU값이 크고 밀도가 크다. 적게 흡수될수록 HU값이 작고 밀도도 작다. 뼈의 경우 700에서 3000사이의 HU값을 가진다.

## 2. 논문의 배경 설명

* 근감소증은 근육량과 근력의 손실을 말하며 특히 일반적으로 감염증, 암 등의 부정적인 질병과 관련이 있는것으로 알려져있습니다. 이때 근육량을 측정할 때 CT data를 분석하게 되는데 현재는 L3 vertebral 부분을 수동으로 추출한 후 소프트웨어와 전문가의 미세조정을 통하여 근육을 반자동으로 분할시킵니다. 이과정에서 소요되는 시간은 한 image당 약 10분이 소요가됩니다.

* 이전의 연구에서는 VGG16 모델을 전이학습시켜 CT data에서 L3 vertebral영역을 감지하고, 또 다른 연구에서는 자동으로 근육 또는 신체 구성 요소의 자동 세분화를 하였습니다.

* 본 논문에서는 CT data에서 근육을 자동으로 분할하기 위해 fully convolutional neural network(FCNN)을 기반으로 효율적이고 일반화 가능한 딥러닝 방법을 개발하여 L3 vertebral 부분을 자동으로 감지하고 해당 섹션의 골격근을 수동 처리 단계 없이 척주세움근(Erector Spinae), 요근(psoas) 그리고 복직근(rectus abdominis)을 순차적으로 분할하며 기존의 연구보다 시간을 단축 시키는 것이 목적입니다. 

## 3. 가설

* CT data에서 근육량을 분석하는 과정을 자동화하게 된다면 근감소증을 측정하기 위해 근육량을 추출하는 연구를 위한 연구를 가속화하며, 표준화가 된다면 의료, 외과 또는 암과 관련된 임상적으로 검증된 측정을 기반으로 임상의에게 예후 정보를 제공하는 잠재적인 기회를 선별하는 도구의 일부로 사용될 것입니다.

## 4. 데이터 실험

- #### Dataset

- #### L3 section setection

- #### muscle segmentation

## 5. 데이터 실험 결과

- #### L3 section setection results

- #### muscle segmentation results

- #### sarcopenia measurements


## 6. 논문에 대한 아이디어

